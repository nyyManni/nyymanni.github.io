<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
          background-image: url("bg.jpg");
          background-size: 100% 100%;
          margin: 0 0 0 0;
          width: 100vw;
          height: 100vh;
      }
      #editor {
          display: flex;
          margin: 0 0 0 0;
          font-family: "Inconsolata", monospace;
          background-color: #0c1014;
          opacity: 0.9;
      }
      #bottom-bar {
          position: fixed;
          vertical-align: center;
          align-content: space-between;
          align-items: center;
          justify-content: space-between;
          display: flex;
          bottom: 2vw;
          width: 100%;
          height: 2vw;
          text-align: center;
          background-color: #0a3749;
          color: #99d1ce;
          font-size: 1.7vw;
      }

      #minibuffer {
          position: fixed;
          bottom: 0px;
          background-color: #0c1014;
          width: 100%;
          height: 2vw;
      }

      #bottom-left {
          display: flex;
          align-content: space-between;
          background-color: #195466;
          text-align: left;
          padding-left: 2%;
      }
      #bottom-center {
          display: flex;
          margin: auto;
          text-align: center;
      }
      #bottom-right {
          background-color: #195466;
          padding-right: 2%;
          text-align: right;
          display: flex;
          align-content: flex-end;
      }
      #state {
          margin-left: 10%;
          margin-right: 10%;
      }
      #major-mode {
          padding-left: 0.66vw;
          padding-right: 0.66vw;
          background-color: #195466;
      }
      #minor-modes {
          padding-left: 0.66vw;
          padding-right: 0.66vw;
          background-color: #195466;
      }

      #t-top {
          width: 1vw;
          height: 1vw;
          background: linear-gradient(45deg, #195466 0.67vw, #0a3749 0.67vw);
      }
      #t-bottom {
          width: 1vw;
          height: 1vw;
          background: linear-gradient(135deg, #195466 0.67vw, #0a3749 0.67vw);
      }
      #tr-bottom {
          width: 1vw;
          height: 1vw;
          background: linear-gradient(45deg, #0a3749 0.67vw, #195466 0.67vw);
      }
      #tr-top {
          width: 1vw;
          height: 1vw;
          background: linear-gradient(135deg, #0a3749 0.67vw, #195466 0.67vw);
      }

      #lines {
          position: fixed;
          width: 100%;
          height: calc(100% - 4vw);
          font-size: 1.7vw;
          overflow: scroll;
          background-color: #0c1014;
      }
      .line {
          display: flex;
          align-content: stretch;

          width: 100%;
      }
      .linum {
          padding-right: 1vw;
          padding-left: 1vw;

          width: 3%;
          font-size: 1.7vw;
          text-align: right;
          color: #245361;
          background-color: #091f2e;
      }
      .highlight {
          color: #99d1ce;
          width: 97%;
      }

      .active > .linum {
          background-color: #195466;
          font-weight: bold;
          color: #99d1ce;
      }
      .active > .highlight {
          background-color: #0a3749;
      }
      ::-webkit-scrollbar {
          width: 0px;  /* remove scrollbar space */
          height: 0px;
          background: transparent;  /* optional: just make scrollbar invisible */
      }
    </style>
  </head>
  <body>

    <div id="editor">
      <div id="lines">
      </div>

      <script type="text/javascript">
        var generated = 0;

        function linumMouseIn(elem, num) {
          document.getElementById("line-indicator").innerHTML = num;
          elem.classList.add("active");
        }
        function linumMouseOut(elem, num) {
          elem.classList.remove("active");
        }

        function generateLineNumbers() {

          // We use font-size of 1.7vw, so we can calculate the amount of rows
          // required.
          var lineHeight = window.innerWidth * 0.017;
          var height = document.getElementById("lines").scrollHeight;

          // Optimize a bit, only calculate when changed...
          var newAmount = Math.ceil(height / lineHeight) + 20;
          if (newAmount > generated) {

            var nums = Array(newAmount - generated).fill().map((e, i)=> `
              <div class="line"
                   onmouseover="linumMouseIn(this, ${generated + i + 1})"
                   onmouseout="linumMouseOut(this, ${generated + i + 1})">
                <div class="linum">
                  ${generated + i + 1}
                </div>
                <div id="line-${generated + i + 1}" class="highlight">
                </div>
              </div>`);
            document.getElementById("lines").innerHTML += nums.join('');
            generated = newAmount;
          }
        }
        // Generate once at page load, and every time window size changes.
        generateLineNumbers();
        window.onresize = generateLineNumbers;

        function writeLine(lineNo, line) {
          lineElem = document.getElementById("line-" + lineNo);

          if (lineElem === null)
            return;

          lineElem.innerHTML = line
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;")
            .replace(/ /g, "&nbsp;");
        }

        function writeLines(beginLine, lines) {
          // Remove newlines from beginning and end of string.
          lines = lines.replace(/^\n|\n$/g, '').split('\n');
          for (var i = 0; i < lines.length; ++i) {
            writeLine(beginLine++, lines[i]);
          }
        }

      </script>

      <div id="bottom-bar">
        <div id="bottom-left">
          <div style="padding-right: 0.66vw;">
            % 4.5k
            <strong>
              nyymanni.com
            </strong>
          </div>
          <div> <div id="t-top"></div> <div id="t-bottom"></div> </div>
        </div>
        <div id="bottom-center">
          <div> <div id="tr-bottom"></div> <div id="tr-top"></div> </div>
          <div id="major-mode">
            HTML
          </div>
          <div> <div id="t-top"></div> <div id="t-bottom"></div> </div>
          <div id="state">
            &lt;N&gt;
          </div>
          <div> <div id="tr-top"></div> <div id="tr-bottom"></div> </div>
          <div id="minor-modes">
            m
          </div>
          <div> <div id="t-bottom"></div> <div id="t-top"></div> </div>
        </div>
        <div id="bottom-right">
          <div> <div id="tr-top"></div> <div id="tr-bottom"></div> </div>
          <div style="padding-left: 0.66vw;">
            <span id="line-indicator">1</span> : 0 All
          </div>
        </div>
      </div>
      <div id="minibuffer">
      </div>
    </div>
    <script type="text/javascript">

      writeLines(2, `
    def func(p1, p2):
        return p1 < p2
`);
    </script>
  </body>
</html>
